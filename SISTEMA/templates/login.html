{% extends "base.html" %}

{% block title %}Iniciar Sesión{% endblock %}

{% block content %}

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
    /* Reset y configuración base */
    body {
        background: linear-gradient(135deg, #002375 0%, #060055 50%, #06035f 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        font-family: 'Poppins', sans-serif; 
    }
    
    body::before {
        content: '';
        position: absolute;
        width: 200%;
        height: 200%;
        background-image: 
            radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 80%, rgba(19, 8, 180, 0.014) 0%, transparent 50%),
            radial-gradient(circle, rgba(255, 255, 255, 0.171) 1px, transparent 1px);
        background-size: 100% 100%, 100% 100%, 40px 40px;
        animation: particleMove 25s linear infinite;
        opacity: 0.6;
    }
    
    @keyframes particleMove {
        0% { transform: translate(0, 0) rotate(0deg); }
        100% { transform: translate(50px, 50px) rotate(360deg); }
    }
    
    .login-container {
        position: relative;
        z-index: 1;
        width: 100%;
    }
    
    .card {
        border-radius: 2rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        border: none;
        backdrop-filter: blur(20px) saturate(180%);
        background: rgba(255, 255, 255, 0.97);
        overflow: hidden;
        animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    @keyframes slideUp {
        from { opacity: 0; transform: translateY(40px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
    }
    
    .card-header {
        background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
        padding: 2.5rem 2rem;
        color: white;
        text-align: center;
    }

    .logo-img {
        max-width: 140px;
        border-radius: 1rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        margin-bottom: 1.5rem;
    }
    
    .card-body { padding: 3rem 2.5rem; }
    
    .form-label { font-weight: 600; color: #475569; }
    
    .input-group-text { background: #f1f5f9; border: 2px solid #e2e8f0; border-right: none; }
    .form-control { border: 2px solid #e2e8f0; border-left: none; padding: 1rem; }
    
    .btn-primary {
        background: linear-gradient(135deg, #0508df 0%, #2c6bf1 50%, #0d3fe4 100%);
        border: none;
        padding: 1.1rem;
        border-radius: 1rem;
        font-weight: 700;
        box-shadow: 0 10px 25px rgba(0, 4, 223, 0.4);
    }

    .card-footer { background: #f8fafc; padding: 1.5rem; border-top: 1px solid rgba(226, 232, 240, 0.5); }
    
    /* Estilo para que el enlace parezca un botón clicable */
    .link-contacto {
        color: #0609b9;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        padding: 5px 10px;
        transition: all 0.3s;
    }
    .link-contacto:hover { background: rgba(6, 9, 185, 0.1); border-radius: 8px; }

    .security-text p {
        background: rgba(255, 255, 255, 0.1);
        padding: 0.75rem 1.5rem;
        border-radius: 2rem;
        color: white;
        font-size: 0.8rem;
    }
</style>

<div class="container my-5 login-container">
    <div class="row justify-content-center">
        <div class="col-sm-10 col-md-8 col-lg-6 col-xl-5"> 
            <div class="card">
                <div class="card-header">
                    <img src="{{ url_for('static', filename='images/LOGO1.PNG') }}" alt="Logo" class="logo-img">
                    <h2 class="mb-2"><i class="fas fa-shield-alt me-2"></i> Sistema de Reportes</h2>
                    <p class="mb-0 opacity-90">Gestión y Control de Operaciones</p>
                </div>
                
                <div class="card-body">
                    <form method="POST" action="{{ url_for('login') }}">
                        <div class="mb-4">
                            <label class="form-label"><i class="fas fa-user"></i> Usuario</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user text-primary"></i></span>
                                <input type="text" class="form-control" name="username" placeholder="Tu usuario" required autofocus>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="form-label"><i class="fas fa-lock"></i> Contraseña</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-key text-primary"></i></span>
                                <input type="password" class="form-control" name="password" placeholder="Tu contraseña" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Iniciar Sesión</button>
                    </form>
                </div>
                
                <div class="card-footer text-center">
                    <p class="mb-0 text-muted small">
                        ¿Problemas para acceder? 
                        <a onclick="abrirContacto()" class="link-contacto">Contacta al administrador</a>
                    </p>
                </div>
            </div>
            
            <div class="text-center mt-4 security-text">
                <p><i class="fas fa-shield-alt me-2"></i> Sistema seguro con encriptación de datos</p>
            </div>
        </div>
    </div>
</div>

<script>
function abrirContacto() {
    const email = 'jsuarez@elmarques.gob.mx';
    
    Swal.fire({
        title: 'Soporte Técnico',
        icon: 'info',
        html: `
            <p>Para recuperar su acceso o reportar un fallo, escriba a:</p>
            <div style="background: #f1f5f9; padding: 15px; border-radius: 10px; border: 1px dashed #0508df; margin: 15px 0;">
                <strong style="font-size: 1.1rem; color: #0508df;">${email}</strong>
            </div>
            <button onclick="copiarEmail('${email}')" class="btn btn-sm btn-outline-primary">
                <i class="fas fa-copy"></i> Copiar correo
            </button>
        `,
        showConfirmButton: true,
        confirmButtonText: 'Cerrar',
        confirmButtonColor: '#1e293b'
    });
}

function copiarEmail(email) {
    navigator.clipboard.writeText(email).then(() => {
        Swal.fire({
            toast: true,
            position: 'top-end',
            icon: 'success',
            title: 'Correo copiado al portapapeles',
            showConfirmButton: false,
            timer: 2000
        });
    });
}
</script>

{% endblock %}